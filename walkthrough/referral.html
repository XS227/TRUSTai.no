<!doctype html>
<html lang="nb">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Henvisning registreres…</title>
  </head>
  <body>
    <p>Registrerer henvisningskode…</p>
    <script>
      const parts = window.location.pathname.split('/').filter(Boolean);
      const aIndex = parts.lastIndexOf('a');
      const referralCode = aIndex >= 0 && parts[aIndex + 1] ? parts[aIndex + 1] : parts[parts.length - 1];

      if (referralCode) {
        localStorage.setItem('ambassadorRef', decodeURIComponent(referralCode).trim().toUpperCase());
      }

      const basePath = window.location.pathname.includes('/a/')
        ? window.location.pathname.split('/a/')[0].replace(/\/$/, '')
        : '';

      window.location.replace(`${basePath}/index.html`.replace(/\/\//g, '/'));
    </script>
  </body>
</html>
